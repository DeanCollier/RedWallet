@model RedWallet.Models.DashboardModels.DashboardViewModel

@if (Model.SelectedWalletId == 0)
{
    <div class="d-flex p-2 justify-content-center">
        <div class="col-lg-15 text-center">
            <div>
                <h1>No Wallets Found.</h1>
                <div class="col-lg-15">
                    <input type="submit" value="Create New Wallet" class="btn btn-long bg-secondary text-white shadow" onclick="location.href='@Url.Action("Create", "Wallet")'" />
                </div>
            </div>
        </div>
    </div>
}
else
{
    <div class="row mt-3 mx-0 px-0 card">
        <div class="col-lg-12 mx-0 px-0" style="background: #dc3545">
            <div id="wallet-dropdown" class="col-5">
                <h2>Select Wallet:</h2>
                <button style="float:left">
                    @Html.DropDownListFor(model => model.UserWallets[0], new SelectList(Model.UserWallets, "WalletId", "WalletName"), htmlAttributes: new { @id = "wallet-input" })
                </button>
            </div>
            <div id="balance-display" class="col-5">
                <h2>Wallet Balance (WIP):</h2>
                <h1>@Model.WalletBalance BTC</h1>
            </div>
        </div>
    </div>

    <div class="row mt-3 mx-0 px-0">
        <div class="col-6 table-responsive">
            <input type="submit" value="Send" class="btn bg-secondary text-white shadow m-0 mb-1" onclick="location.href='@Url.Action("Create", "Send", new { walletId = Model.SelectedWalletId })'" />
            <div id="sends-display" class="col-5 card shadow">
                <table class="table table-striped table-dark table-bordered" cellspacing="0">
                    <thead>
                        <tr>
                            <th class="th-sm text-center">
                                Created
                            </th>
                            <th class="th-sm text-center">
                                Transaction
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var item in Model.WalletSends)
                        {
                            <tr>
                                <td>@item.Created.ToString("MM/dd/yyyy hh:mm tt")</td>
                                <td>@Html.ActionLink(item.TransactionHash, "Details", "Send", new { id = item.SendId }, new { @class = "detail-link" })</td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
        <div class="col-6">
            <input type="submit" value="Receive" class="btn bg-secondary text-white shadow m-0 mb-1" onclick="location.href='@Url.Action("Create", "Request", new { walletId = Model.SelectedWalletId })'" />

            <div id="sends-display" class="col-5 table-responsive card shadow">
                <table class="table table-striped table-dark table-bordered" cellspacing="0">
                    <thead>
                        <tr>
                            <th class="th-sm text-center">
                                Public Addresses Created
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var item in Model.WalletAddresses)
                        {
                            <tr>
                                <td>@Html.ActionLink(item.RequestAddress, "Details", "Request", new { id = item.RequestId }, new { @class = "detail-link" })</td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>
}

<script>
    window.addEventListener("DOMContentLoaded", function () {
        if (window.location.href.slice(window.location.href.lastIndexOf('/') + 1) != "") {
            document.getElementById("wallet-input").value = window.location.href.slice(window.location.href.lastIndexOf('/') + 1)

        }
        setLinks(document.getElementById("wallet-input").value)

    })
    function setLinks(walletId) {
        var walletLink = document.getElementById("wallet-nav-link")
        var sendLink = document.getElementById("send-nav-link")
        var requestLink = document.getElementById("request-nav-link")

        walletLink.setAttribute("href", `/Wallet/Details/${walletId}`)
        sendLink.setAttribute("href", `/Send?walletId=${walletId}`)
        requestLink.setAttribute("href", `/Request?walletId=${walletId}`)
    }
    function handleClick() {
        window.location.href = `/Dashboard/Index/${document.getElementById("wallet-input").value}`

    }
    // Drop down click event
    document.getElementById("wallet-input").addEventListener("change", handleClick)
</script>

@Scripts.Render("~/bundles/jquery")
@Scripts.Render("~/bundles/bootstrap")

